<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Company Account</title>
    <style>
body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }
        table {
            border-collapse: collapse;
            width: 100%;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        h1, h2 {
            text-align: center;
        }
        p {
            text-align: center;
            font-size: 150%;
            font-weight: 1000;
        }
        .button-container {
            text-align: center;
            margin: 20px 0;
        }
        .profit-button {
            display: inline-block;
            margin: 10px;
            padding: 10px 20px;
            font-size: 16px;
            border-radius: 15px;
            cursor: pointer;
            background-color: #4CAF50;
            color: white;
            border: none;
            transition: background-color 0.3s ease;
        }
        .profit-button:hover {
            background-color: #45a049;
        }
        #savePdfButton {
            display: block;
            margin: 20px auto;
            padding: 10px 20px;
            font-size: 16px;
            border-radius: 15px;
            cursor: pointer;
            background-color: #2196F3;
            color: white;
            border: none;
            transition: background-color 0.3s ease;
        }
        #savePdfButton:hover {
            background-color: #0b7dda;
        }
        @media only screen and (max-width: 600px) {
            table {
                font-size: 80%;
            }
            th, td {
                padding: 6px;
            }
            h1, h2 {
                font-size: 24px;
            }
            p {
                font-size: 120%;
            }
            .profit-button, #savePdfButton {
                font-size: 14px;
                padding: 8px 16px;
            }
        }
        @media only screen and (min-width: 768px) {
            table {
                font-size: 100%;
            }
            th, td {
                padding: 10px;
            }
            h1, h2 {
                font-size: 36px;
            }
            p {
                font-size: 150%;
            }
        }
        @media only screen and (max-width: 414px) {
            table {
                font-size: 80%;
            }
            th, td {
                padding: 6px;
            }
            h1, h2 {
                font-size: 24px;
            }
            p {
                font-size: 120%;
            }
        }
        @media only screen and (min-width: 768px) and (max-width: 1024px) {
            table {
                font-size: 90%;
            }
            th, td {
                padding: 8px;
            }
            h1, h2 {
                font-size: 32px;
            }
            p {
                font-size: 130%;
            }
        }
    </style>
    <!-- Include html2pdf.js library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
</head>
<body>
    <h1>Company Tracker Account</h1>
    <div class="button-container">
        <button id="totalProfitButton" class="profit-button">Total Profit</button>
        <button id="dailyProfitButton" class="profit-button">Daily Profit</button>
        <button id="weeklyProfitButton" class="profit-button">Weekly Profit</button>
        <button id="monthlyProfitButton" class="profit-button">Monthly Profit</button>
        <button id="yearlyProfitButton" class="profit-button">Yearly Profit</button>
    </div>
    <div id="pdfContent">
      <div class="Company">
        <h2>Product Account Details</h2>
      </div>
        <table>
            <thead>
                <tr>
                    <th>Item</th>
                    <th>Purchase Date</th>
                    <th>Quantity</th>
                    <th>Cost Price</th>
                    <th>Selling Price</th>
                    <th>Profit</th>
                </tr>
            </thead>
            <tbody id="productList"></tbody>
        </table>
        <div id="summaryMessages"></div>
    </div>
    <button id="savePdfButton" style="display: block; margin: 20px auto; padding: 10px 20px; font-size: 16px; border-radius: 15px; cursor: pointer;">Save as PDF</button>
    <script>
        const products = JSON.parse(localStorage.getItem('products') || '[]');

        function calculateProfit(product) {
            return (product.sellingPrice - product.costPrice) * product.quantity;
        }

        function populateProductsSummary() {
            const productList = document.getElementById('productList');
            productList.innerHTML = '';

            let totalProfit = 0;
            let totalLoss = 0;

            products.forEach(product => {
                const row = document.createElement('tr');
                const profit = calculateProfit(product);
                totalProfit += profit > 0 ? profit : 0;
                totalLoss += profit < 0 ? -profit : 0;

                row.innerHTML = `
                    <td>${product.item}</td>
                    <td>${product.purchaseDate}</td>
                    <td>${product.quantity}</td>
                    <td>$${product.costPrice.toFixed(2)}</td>
                    <td>$${product.sellingPrice.toFixed(2)}</td>
                    <td>$${profit.toFixed(2)}</td>
                `;
                productList.appendChild(row);
            });

            const totalProfitRow = document.createElement('tr');
            totalProfitRow.innerHTML = `<td colspan="5">Total Profit</td><td>$${totalProfit.toFixed(2)}</td>`;
            productList.appendChild(totalProfitRow);

            const totalLossRow = document.createElement('tr');
            totalLossRow.innerHTML = `<td colspan="5">Total Loss</td><td>$${totalLoss.toFixed(2)}</td>`;
            productList.appendChild(totalLossRow);
        }

        function toggleSummaryMessage(period) {
            const existingMessage = document.getElementById(`${period}Message`);
            if (existingMessage) {
                existingMessage.remove();
                return;
            }

            const now = new Date();
            let filteredProducts = [];

            products.forEach(product => {
                const purchaseDate = new Date(product.purchaseDate);
                switch (period) {
                    case 'daily':
                        if (purchaseDate.toDateString() === now.toDateString()) {
                            filteredProducts.push(product);
                        }
                        break;
                    case 'weekly':
                        const oneWeekAgo = new Date();
                        oneWeekAgo.setDate(now.getDate() - 7);
                        if (purchaseDate >= oneWeekAgo && purchaseDate <= now) {
                            filteredProducts.push(product);
                        }
                        break;
                    case 'monthly':
                        if (purchaseDate.getMonth() === now.getMonth() && purchaseDate.getFullYear() === now.getFullYear()) {
                            filteredProducts.push(product);
                        }
                        break;
                    case 'yearly':
                        if (purchaseDate.getFullYear() === now.getFullYear()) {
                            filteredProducts.push(product);
                        }
                        break;
                    case 'total':
                        filteredProducts.push(product);
                        break;
                }
            });

            let totalProfit = 0;
            let totalLoss = 0;

            filteredProducts.forEach(product => {const profit = calculateProfit(product);
                totalProfit += profit > 0 ? profit : 0;
                totalLoss += profit < 0 ? -profit : 0;
            });

            const totalProfitLoss = totalProfit - totalLoss;
            const message = totalProfitLoss >= 0 ? 
                `Your ${period} profit is $${totalProfitLoss.toFixed(2)}` : 
                `Your ${period} loss is $${Math.abs(totalProfitLoss).toFixed(2)}`;

            const summaryMessages = document.getElementById('summaryMessages');
            const newMessage = document.createElement('p');
            newMessage.id = `${period}Message`;
            newMessage.textContent = message;
            summaryMessages.appendChild(newMessage);
        }

        window.onload = function() {
            populateProductsSummary();
        };

        document.getElementById('totalProfitButton').addEventListener('click', () => {
            toggleSummaryMessage('total');
        });
        document.getElementById('dailyProfitButton').addEventListener('click', () => {
            toggleSummaryMessage('daily');
        });
        document.getElementById('weeklyProfitButton').addEventListener('click', () => {
            toggleSummaryMessage('weekly');
        });
        document.getElementById('monthlyProfitButton').addEventListener('click', () => {
            toggleSummaryMessage('monthly');
        });
        document.getElementById('yearlyProfitButton').addEventListener('click', () => {
            toggleSummaryMessage('yearly');
        });
 document.getElementById('savePdfButton').addEventListener('click', () => {
    const element = document.getElementById('pdfContent');
    const opt = {
        margin: 0.5,
        filename: 'company_account.pdf',
        image: { type: 'jpeg', quality: 0.98 },
        html2canvas: { scale: 2 },
        jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' },
        html2pdf: {
            html2canvas: { scale: 2 },
            jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' },
            margin: 0.5,
            filename: 'company_account.pdf',
            pagebreak: { mode: 'avoid-all', before: '#pdfContent' }
        }
    };

    // Show buttons during PDF generation
    const buttonsToShow = document.querySelectorAll('.profit-button');
    buttonsToShow.forEach(button => button.style.display = 'inline-block');

    html2pdf().from(element).set(opt).save().finally(() => {
        // Restore original display for buttons after PDF generation
        buttonsToShow.forEach(button => button.style.display = 'inline-block');
    });
});
    </script>
</body>
</html>